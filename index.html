<!DOCTYPE html>
<html lang="pt-BR">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>Wm Assessoria</title>
  <link rel="icon" href="logo.png" />
  <link rel="manifest" href="manifest.json" />
  <style>
    @import url('https://fonts.googleapis.com/css2?family=Playfair+Display:wght@600&display=swap');

    body {
      margin: 0;
      font-family: Arial, sans-serif;
      background: linear-gradient(to bottom right, #7d7d7d, #2f2f2f);
      color: white;
    }

    header {
      background: #fdfaf1;
      color: #9c7b2d;
      padding: 15px 30px;
      display: flex;
      justify-content: space-between;
      align-items: center;
      font-family: 'Playfair Display', serif;
    }

    header img {
      height: 32px;
    }

    header h1 {
      margin: 0;
      font-size: 22px;
    }

    #counter {
      font-size: 14px;
      font-weight: bold;
      color: gold;
    }

    .container {
      padding: 20px;
    }

    input[type="file"] {
      margin-bottom: 20px;
    }

    .lead {
      background-color: #444;
      border: 2px solid transparent;
      padding: 10px;
      margin-bottom: 10px;
      border-radius: 8px;
    }

    .lead.active {
      border-color: gold;
    }

    .lead strong {
      display: block;
      margin-bottom: 5px;
    }

    .btn {
      padding: 6px 12px;
      margin: 0 5px 5px 0;
      border: none;
      border-radius: 6px;
      font-weight: bold;
      cursor: pointer;
      font-size: 14px;
      transition: 0.3s;
      text-decoration: none;
      display: inline-block;
    }

    .btn-call { background-color: #C5A046; color: white; }
    .btn-call:hover { background-color: #b8943f; }

    .btn-whatsapp { background-color: #25D366; color: white; }
    .btn-save { background-color: #333; color: white; }
    .btn-clear { background-color: red; color: white; margin-left: 10px; }

    textarea {
      width: 100%;
      border-radius: 6px;
      margin-top: 8px;
      resize: vertical;
    }
  </style>
</head>
<body>
  <header>
    <img src="logo.png" alt="Wm Assessoria" />
    <h1>Wm Assessoria</h1>
    <div id="counter">ðŸ“ž LigaÃ§Ãµes: <span id="count">0</span></div>
  </header>
  <div class="container">
    <input type="file" id="fileInput" accept=".csv,.xlsx" />
    <button class="btn btn-clear" onclick="clearLeads()">Limpar Planilha</button>
    <div id="leadList"></div>
  </div>

  <script src="https://cdn.jsdelivr.net/npm/xlsx/dist/xlsx.full.min.js"></script>
  <script>
    let leads = [];
    let count = 0;

    function updateCounter() {
      document.getElementById("count").innerText = count;
    }

    function clearLeads() {
      document.getElementById("leadList").innerHTML = "";
      leads = [];
    }

    function highlight(index) {
      document.querySelectorAll('.lead').forEach(el => el.classList.remove('active'));
      const current = document.querySelectorAll('.lead')[index];
      if (current) current.classList.add('active');
    }

    function renderLeads() {
      const list = document.getElementById("leadList");
      list.innerHTML = "";
      leads.forEach((lead, i) => {
        const numeroLimpo = lead.numero.replace(/\D/g, "");
        const div = document.createElement("div");
        div.className = "lead";
        div.innerHTML = `
          <strong>${lead.nome} â€“ ${lead.numero}</strong>
          <a class="btn btn-call" href="tel:${numeroLimpo}" onclick="highlight(${i}); count++; updateCounter();">ðŸ“ž Ligar</a>
          <a class="btn btn-whatsapp" href="https://wa.me/55${numeroLimpo}" target="_blank">WhatsApp</a>
          <button class="btn btn-save" onclick="alert('Salvo!')">Salvar</button>
          <textarea placeholder="ObservaÃ§Ãµes..."></textarea>
        `;
        list.appendChild(div);
      });
    }

    document.getElementById("fileInput").addEventListener("change", function(e) {
      const reader = new FileReader();
      reader.onload = function(e) {
        const data = new Uint8Array(e.target.result);
        const workbook = XLSX.read(data, {type: 'array'});
        const sheet = workbook.Sheets[workbook.SheetNames[0]];
        const json = XLSX.utils.sheet_to_json(sheet);
        leads = json.map(row => ({
          nome: row.nome || row.Nome || row.NOME || "",
          numero: String(row.numero || row.NÃºmero || row.NUMERO || row.telefone || "")
        })).filter(l => l.nome && l.numero);
        renderLeads();
      };
      reader.readAsArrayBuffer(e.target.files[0]);
    });
  </script>
</body>
</html>